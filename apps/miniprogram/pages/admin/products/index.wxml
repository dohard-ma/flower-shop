<view class="container">
    <!-- ä»»åŠ¡åˆ—è¡¨ -->
    <view class="task-list">
        <view class="task-item" wx:for="{{uploadTasks}}" wx:key="id" data-item="{{item}}" data-task-id="{{item.id}}" bindtap="onTaskItemTap" data-index="{{index}}">
            <!-- å¤é€‰æ¡†ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰ -->
            <view class="checkbox-container" catchtap="onCheckboxTap" data-task-id="{{item.id}}">
                <checkbox value="{{item.id}}" checked="{{item.selected}}" />
            </view>
            <!-- å›¾ç‰‡ç¼©ç•¥å›¾ -->
            <view class="image-container">
                <image src="{{item.image}}" mode="aspectFill" class="thumbnail" />
            </view>
            <!-- ä»»åŠ¡ä¿¡æ¯ -->
            <view class="task-info">
                <!-- æ ‡é¢˜å’ŒçŠ¶æ€ -->
                <view class="title-row">
                    <view class="title">{{ item.title || 'å¤„ç†ä¸­...'  }}</view>
                    <view class="status-text {{item.status}}">
                        <text wx:if="{{item.status === 'uploading'}}">ä¸Šä¼ ä¸­</text>
                        <text wx:if="{{item.status === 'analyzing'}}">AIåˆ†æä¸­</text>
                        <text wx:if="{{item.status === 'pending'}}">å¾…ç¡®è®¤</text>
                        <text wx:if="{{item.status === 'confirmed'}}">å·²ç¡®è®¤</text>
                        <text wx:if="{{item.status === 'failed'}}">å¤„ç†å¤±è´¥</text>
                    </view>
                </view>
                <!-- ä»·æ ¼å’Œåˆ†ç±» -->
                <view class="detail-row" wx:if="{{item.title}}">
                    <view class="price">Â¥{{item.price || '0.00'}}</view>
                    <view class="category" wx:if="{{item.category}}">{{item.category}}</view>
                </view>
                <!-- é”™è¯¯ä¿¡æ¯ -->
                <view class="error-message" wx:if="{{item.status === 'failed' && item.error}}">
                    <text class="error-text">{{item.error}}</text>
                </view>
            </view>
            <!-- æ“ä½œåŒºåŸŸ -->
            <view class="action-area">
                <!-- å¯ç¼–è¾‘çŠ¶æ€æ˜¾ç¤ºç®­å¤´ -->
                <view class="arrow" wx:if="{{item.status === 'pending' || item.status === 'confirmed'}}">
                    <text class="arrow-icon">
                        <image src="/assets/icons/arrow-right.svg" mode="aspectFill" class="arrow-icon-image" />
                    </text>
                </view>
            </view>
        </view>
        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:if="{{!uploadTasks || uploadTasks.length === 0}}">
            <text class="empty-icon">ğŸ“¸</text>
            <text class="empty-text">è¿˜æ²¡æœ‰ä¸Šä¼ ä»»åŠ¡</text>
            <text class="empty-desc">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æ‰¹é‡ä¸Šä¼ å›¾ç‰‡</text>
        </view>
    </view>
    <view class="footer">
        <!-- æœ‰é€‰ä¸­é¡¹æ—¶æ˜¾ç¤ºæ‰¹é‡æ“ä½œæŒ‰é’® -->
        <view class="batch-actions" wx:if="{{selectedTasks.length > 0}}">
            <view class="batch-btn cancel-btn" bindtap="clearSelection">
                <text class="btn-text">å–æ¶ˆ</text>
            </view>
            <view class="batch-btn delete-btn" bindtap="onBatchDelete">
                <text class="btn-text">åˆ é™¤ ({{selectedTasks.length}})</text>
            </view>
            <view class="batch-btn analyze-btn" bindtap="onBatchReanalyze">
                <text class="btn-text">é‡æ–°åˆ†æ ({{selectedTasks.length}})</text>
            </view>
        </view>
        <!-- æ— é€‰ä¸­é¡¹æ—¶æ˜¾ç¤ºæ­£å¸¸æŒ‰é’®ç»„ -->
        <view class="button-group" wx:else>
            <!-- AIåˆ†æå¼€å…³æŒ‰é’® -->
            <view class="ai-toggle-button {{aiAnalysisEnabled ? 'enabled' : 'disabled'}}" bindtap="toggleAIAnalysis">
                <text class="ai-icon">{{aiAnalysisEnabled ? 'ğŸ¤–' : 'ğŸš«'}}</text>
                <text class="ai-text">{{aiAnalysisEnabled ? 'AIåˆ†æå·²å¼€å¯' : 'AIåˆ†æå·²å…³é—­'}}</text>
            </view>
            <!-- æ‰¹é‡ä¸Šä¼ æŒ‰é’® -->
            <view class="add-button" bindtap="onAddProduct">
                <text class="add-icon">ğŸ“·</text>
                <text class="add-text">æ‰¹é‡ä¸Šä¼ å›¾ç‰‡</text>
            </view>
        </view>
    </view>
</view>