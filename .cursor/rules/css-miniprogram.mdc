---
name: css-miniprogram
description: 只针对 apps/miniprogram 目录下的样式文件的 CSS 规范
globs:
  - "apps/miniprogram/**/*.wxml"
  - "apps/miniprogram/**/*.scss"
  - "apps/miniprogram/**/*.wxss"
cursorRuleType: specificFiles   # 可省略，带 globs 会自动识别为 specificFiles
---


# 一人公司小程序开发全局规则 (微信小程序 + TDesign)

## 核心哲学

- **以产定入**：所有的代码修改必须直接指向当前的功能目标，严禁无意义的重构。
- **借力不造**：优先使用原子类样式和 TDesign 组件，能不写自定义 CSS 就不写。
- **说人话，杀痛点**：交互逻辑要简单易用（如箭头排序优于拖拽），代码注释要直指业务目的。
- **敬畏现实**：优先实现 MVP 逻辑，代码要鲁棒，删除等敏感操作必须有二次确认和依赖检查。

## CSS 与 UI 规范 (强制执行)

### 1. 原子类优先原则

- **禁止私产**：严禁在页面特定的 `.wxss` 或 `.scss` 中编写业务语义类名（如 `.category-item`）。
- **98% 覆盖率**：UI 必须由全局 `atom.wxss` 中的原子类组合而成。
- **TDesign 协同**：复杂组件借力 TDesign，布局、间距、外层包装使用原子类。

### 2. "活的原子" 维护协议 (分类索引)

当发现样式缺失时，必须遵循以下流程：

1. **禁止行内样式**：严禁使用 `style="margin: 20rpx"`。
2. **分类定位**：根据样式属性，确定它属于 `atom.wxss` 的哪个区块：
    - [Layout] 布局
    - [Spacing] 间距 (m, mt, mb, ml, mr, p, pt, pb, pl, px, py, gap)
    - [Visual] 视觉 (bg, rounded, border)
    - [Typography] 字体排版 (text, font)
    - [Sizing & Position] 尺寸与定位 (w, h, relative, absolute, fixed)
3. **有序插入**：在对应区块内按数值升序插入。
4. **同步输出**：在代码回答的末尾，明确告知用户需要将哪段代码插入到 `atom.wxss` 的哪个位置。

### 3. 命名与单位

- **单位**：所有尺寸必须使用 `rpx`。
- **风格**：遵循 Tailwind 风格，如 `mt-20` 代表 `margin-top: 20rpx`，`text-333` 代表 `color: #333333`。

## 代码逻辑准则 (TS/JS)

- [cite_start]**防御性编程**：删除操作前必须检查关联性（如检查商品数量 [cite: 66]）。
- **交互反馈**：长按、成功保存、移动排序等操作必须调用 `wx.vibrateShort()` 提供物理反馈。
- **简单胜过复杂**：排序逻辑优先使用数组索引交换（Arrow Buttons），除非用户明确要求复杂拖拽。

## 语言与交互

- **沟通语言**：所有解释、注释、提示信息必须使用【中文】。
- **代码命名**：变量名、函数名保持英文。
